import{_ as Z,o as z,i as J,r as d,G as w,a as r,b as D,c as M,d as l,k as a,g as m,f as o,F as j,p as K,u as F,e as Q,t as f,H as W,m as X}from"./index-DFO3MUi4.js";import{e as x,n as V,c as h}from"./confirm-DrgE0thk.js";import{D as ee}from"./DockerService-4sbkR7SL.js";const te={class:"article-area"},le={class:"flex justify-between items-center"},ae={class:"flex gap-x-2"},oe={class:"article-area pt-4"},se={class:"flex gap-x-4"},ne={class:"flex justify-between items-center"},re={class:"pt-3 space-y-3"},ue={__name:"DockerCtnMngPage",setup(ie){z(()=>{p()});const b=J("axios"),g=d(!0),c=d(!1),P=d([]),v=d(),u=d({containerName:"",imageName:"",etrPort:12e3,itrPort:8080}),H=d({containerName:[{required:!0,message:"컨테이너명을 입력해주세요",trigger:"blur"}],imageName:[{required:!0,message:"이미지명을 입력해주세요",trigger:"blur"}],etrPort:[{required:!0,message:"외부포트를 입력해주세요",trigger:"blur"}],itrPort:[{required:!0,message:"내부포트를 입력해주세요",trigger:"blur"}]}),i=d(!1),s=d({}),p=()=>{ee.getContainerAll().then(n=>P.value=n)},q=(n,e)=>{s.value[e.ID]=!s.value[e.ID]},I=()=>{i.value=!0,v.value&&(v.value.clearValidate(),v.value.resetFields())},U=()=>{v.value.validate(n=>{n&&x("선택한 이미지로 컨테이너를 실행하시겠습니까?","이미지").then(()=>{b.post("/docker/image/start",u.value).then(e=>{V("이미지","이미지 실행 완료","success"),p(),i.value=!1})})})},Y=()=>{x("컨테이너를 삭제하시겠습니까?","컨테이너").then(async()=>{const n=Object.keys(s.value).filter(e=>s.value[e]);for(const e of n)await b.post("/docker/container/delete",{containerName:e});V("컨테이너","컨테이너 삭제 완료","success"),p(),i.value=!1})},L=()=>{x("컨테이너를 재실행하시겠습니까?","이미지").then(async()=>{const n=Object.keys(s.value).filter(e=>s.value[e]);for(const e of n)await b.post("/docker/container/start",{containerName:e});V("이미지","이미지 재실행 완료","success"),p(),i.value=!1})},B=()=>{x("컨테이너를 중단하시겠습니까?","컨테이너").then(async()=>{const n=Object.keys(s.value).filter(e=>s.value[e]);for(const e of n)await b.post("/docker/container/stop",{containerName:e});V("컨테이너","컨테이너 중단 완료","success"),p(),i.value=!1})};return w(c,()=>{p()}),w(s,()=>{g.value=!Object.keys(s.value).some(n=>s.value[n])},{deep:!0}),(n,e)=>{const O=r("el-switch"),R=r("el-text"),N=r("el-button"),S=r("el-card"),A=r("el-checkbox"),G=r("el-tag"),_=r("el-input"),k=r("el-form-item"),y=r("el-descriptions-item"),$=r("el-descriptions"),E=r("el-form"),T=r("el-dialog");return D(),M(j,null,[l("article",te,[l("div",le,[l("div",null,[a(O,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t)},null,8,["modelValue"]),e[10]||(e[10]=m("  ")),a(R,{onClick:e[1]||(e[1]=t=>c.value=!c.value),type:c.value?"primary":"info",class:"cursor-pointer"},{default:o(()=>e[9]||(e[9]=[m(" 실행중 컨테이너만 표시 ")])),_:1},8,["type"])]),l("div",ae,[a(N,{onClick:Y,link:"",disabled:g.value},{default:o(()=>e[11]||(e[11]=[m(" 삭제 ")])),_:1},8,["disabled"]),a(N,{onClick:B,link:"",disabled:g.value},{default:o(()=>e[12]||(e[12]=[m(" 중단 ")])),_:1},8,["disabled"]),a(N,{onClick:L,link:"",disabled:g.value},{default:o(()=>e[13]||(e[13]=[m(" 실행 ")])),_:1},8,["disabled"])])])]),l("article",oe,[l("div",se,[a(S,{onClick:I,class:"card-box hover:!bg-gray-50"},{default:o(()=>e[14]||(e[14]=[l("div",{class:"w-full pb-14 h-80 max-h-80 flex flex-col justify-center items-center"},[l("p",{class:"text-gray-500 text-4xl rounded-full bg-gray-50 py-4 px-6"},"+"),l("br"),l("p",{class:"text-gray-500"},"새로운 컨테이너 등록")],-1)])),_:1}),(D(!0),M(j,null,K(P.value,t=>(D(),Q(S,{key:t.ID,class:"card-box",onClick:C=>q(C,t)},{default:o(()=>[l("div",ne,[a(A,{modelValue:s.value[t.ID],"onUpdate:modelValue":C=>s.value[t.ID]=C,onClick:e[2]||(e[2]=W(()=>{},["stop"]))},{default:o(()=>[m(f(t.ID),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),a(G,null,{default:o(()=>[m(f(t.State==="created"&&"실행전"||t.State==="running"&&"실행중"||t.State==="paused"&&"일시정지"||t.State==="restarting"&&"재시작중"||t.State==="exited"&&"종료"||t.State==="dead"&&"중단(복구불가)"||t.State==="removing"&&"삭제중"||t.State||"-"),1)]),_:2},1024)]),l("div",re,[l("div",null,[e[15]||(e[15]=l("p",{class:"font-bold"},"컨테이너명",-1)),l("p",null,f(t.Names),1)]),l("div",null,[e[16]||(e[16]=l("p",{class:"font-bold"},"컨테이너 연결포트",-1)),m(" "+f(t.Ports),1)]),l("div",null,[e[17]||(e[17]=l("p",{class:"font-bold"},"컨테이너 생성일",-1)),l("p",null,f(F(X)(t.CreatedAt,"YYYY-MM-DD HH:mm:ss Z").format("YYYY.MM.DD hh:mm")),1)]),l("div",null,[e[18]||(e[18]=l("p",{class:"font-bold"},"관련 이미지",-1)),l("p",null,f(t.Image),1)])])]),_:2},1032,["onClick"]))),128))])]),a(T,{title:"컨테이너",modelValue:i.value,"onUpdate:modelValue":e[8]||(e[8]=t=>i.value=t),"align-center":"","before-close":function(t){F(h)().then(()=>t())}},{default:o(()=>[a(E,{ref_key:"ctnFrmRef",ref:v,model:u.value,rules:H.value},{default:o(()=>[a($,{column:2,border:""},{default:o(()=>[a(y,{label:"대상 이미지",span:"2"},{default:o(()=>[a(k,{prop:"imageName",required:"",class:"py-2 !mb-0"},{default:o(()=>[a(_,{modelValue:u.value.imageName,"onUpdate:modelValue":e[3]||(e[3]=t=>u.value.imageName=t),placeholder:"이미지명 (임시)"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,{label:"컨테이너명",span:"2"},{default:o(()=>[a(k,{prop:"containerName",required:"",class:"py-2 !mb-0"},{default:o(()=>[a(_,{modelValue:u.value.containerName,"onUpdate:modelValue":e[4]||(e[4]=t=>u.value.containerName=t),placeholder:"컨테이너명"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,{label:"외부포트"},{default:o(()=>[a(k,{prop:"etrPort",required:"",class:"py-2 !mb-0"},{default:o(()=>[a(_,{modelValue:u.value.etrPort,"onUpdate:modelValue":e[5]||(e[5]=t=>u.value.etrPort=t),placeholder:"외부포트",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,{label:"내부포트"},{default:o(()=>[a(k,{prop:"itrPort",required:"",class:"py-2 !mb-0"},{default:o(()=>[a(_,{modelValue:u.value.itrPort,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value.itrPort=t),placeholder:"외부포트",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),footer:o(()=>[l("div",{onClick:e[7]||(e[7]=t=>i.value=!1)},"취소"),l("div",{onClick:U},"저장")]),_:1},8,["modelValue","before-close"])],64)}}},pe=Z(ue,[["__scopeId","data-v-c10c9fd7"]]);export{pe as default};
