import{b as O,q as I,u as L,k as F,r as g,s as r,o as z,c as G,a as d,i as e,l as _,x as a,M as J,h as p,N as K,O as Q,t as M,C as f,E as W}from"./index-C9c7Zp6v.js";import{r as X,a as Z,b as ee,n as w,N as k}from"./confirm-DYmZw3Bi.js";const le={class:"section-area"},ae={class:"article-area",style:{display:"flex","justify-content":"space-between","align-items":"center"}},te={style:{padding:"1rem 0","text-align":"end"}},oe={class:"article-area"},re={style:{display:"flex","align-items":"center"}},ne=`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
`,ue={__name:"ProjectMngPage",setup(de){O(()=>{V()});const D=I("axios");L(),F();const v=g(),P=g({projectName:[{required:!0,message:"프로젝트명을 입력해주세요",trigger:"blur"}],projectUrl:[{required:!0,message:"도메인 주소를 입력해주세요",trigger:"blur"}],containerName:[{required:!0,message:"컨테이너명을 입력해주세요",trigger:"blur"}],imageName:[{required:!0,message:"이미지명을 입력해주세요",trigger:"blur"}],etrPort:[{required:!0,message:"외부포트를 입력해주세요",trigger:"blur"}],itrPort:[{required:!0,message:"내부포트를 입력해주세요",trigger:"blur"}]}),Y=g([]),c=g(!1),l=g({projectUid:null,projectName:"",projectUrl:"",containerName:"",imageName:"",etrPort:"",itrPort:"",domainDateRange:[],sslDateRange:[],domainSdate:"",domainEdate:"",sslSdate:"",sslEdate:""}),V=()=>{D.get("/docker/project").then(n=>{Y.value=n.data})},R=n=>{c.value=!0,y()},U=()=>{v.value.validate(n=>{n&&(l.value.domainDateRange.length===2&&(l.value.domainSdate=f(l.value.domainDateRange[0]).format("YYYY-MM-DD"),l.value.domainEdate=f(l.value.domainDateRange[1]).format("YYYY-MM-DD")),l.value.sslDateRange.length===2&&(l.value.sslSdate=f(l.value.sslDateRange[0]).format("YYYY-MM-DD"),l.value.sslEdate=f(l.value.sslDateRange[0]).format("YYYY-MM-DD")),Z().then(()=>{D.post("/docker/project/save",l.value).then(()=>{c.value=!1,ee(),getDataAll()})}))})},E=n=>{y(),c.value=!0,l.value=Object.assign({},n),l.value.domainDateRange=[l.value.domainSdate,l.value.domainEdate],l.value.sslDateRange=[l.value.sslSdate,l.value.sslEdate]},y=()=>{v.value&&v.value.clearValidate(),l.value={projectUid:null,projectName:"",projectUrl:"",containerName:"",imageName:"",etrPort:"",itrPort:"",domainDateRange:[],sslDateRange:[],domainSdate:"",domainEdate:"",sslSdate:"",sslEdate:""}},S=()=>{V(),X()},x=n=>{const t=W.service({lock:!0,text:"프로젝트 배포중",spinner:ne,svgViewBox:"-10, -10, 50, 50",background:"rgba(0, 0, 0, 0.7)",fullscreen:!0});D.post("/docker/deploy",n).then(s=>{w("배포 성공",`${n.containerName} 컨테이너가 실행되었습니다`,k.SUCCESS)}).catch(()=>{w("배포 실패",`${n.containerName} 컨테이너 배포에 실패했습니다`,k.Error)}).finally(()=>{t.close()})};return(n,t)=>{const s=r("el-input"),b=r("el-button"),C=r("el-tag"),m=r("el-table-column"),h=r("Setting"),N=r("el-icon"),q=r("VideoPlay"),A=r("el-table"),i=r("el-form-item"),u=r("el-descriptions-item"),j=r("el-date-picker"),H=r("el-descriptions"),T=r("el-form"),$=r("el-dialog");return z(),G("section",le,[d("article",ae,[d("div",null,[e(s,{style:{width:"250px"},"suffix-icon":_(J),placeholder:"검색어를 입력해주세요"},null,8,["suffix-icon"])]),d("div",te,[d("div",null,[e(b,{onClick:S,icon:_(K),link:""},{default:a(()=>t[10]||(t[10]=[p(" 새로고침 ")])),_:1},8,["icon"]),e(b,{onClick:R,icon:_(Q),link:""},{default:a(()=>t[11]||(t[11]=[p(" 추가 ")])),_:1},8,["icon"])])])]),d("article",oe,[e(A,{data:Y.value,border:""},{default:a(()=>[e(m,{label:"상태",align:"center",width:"100"},{default:a(o=>[e(C,null,{default:a(()=>t[12]||(t[12]=[p(" 테스트 ")])),_:1})]),_:1}),e(m,{prop:"projectName",label:"프로젝트명",width:"200"}),e(m,{prop:"projectUrl",label:"사이트 주소"}),e(m,{label:"만기일",align:"center"},{default:a(()=>[e(m,{prop:"domainEdate",label:"도메인",align:"center",width:"150"},{default:a(o=>[p(M(o.row.domainEdate?"~ "+_(f)(o.row.domainEdate).format("YYYY.MM.DD"):"미등록"),1)]),_:1}),e(m,{prop:"sslEdate",label:"인증서",align:"center",width:"150"},{default:a(o=>[p(M(o.row.sslEdate?"~ "+_(f)(o.row.sslEdate).format("YYYY.MM.DD"):"미등록"),1)]),_:1})]),_:1}),e(m,{label:"작업",align:"center",width:"150"},{default:a(o=>[d("div",re,[e(b,{class:"w-full",link:"",type:"info",onClick:B=>E(o.row)},{default:a(()=>[e(N,null,{default:a(()=>[e(h)]),_:1}),t[13]||(t[13]=p(" 관리 "))]),_:2},1032,["onClick"]),e(b,{class:"w-full",link:"",type:"primary",onClick:B=>x(o.row),disabled:o.row.etrPort===0&&o.row.itrPort===0},{default:a(()=>[e(N,null,{default:a(()=>[e(q)]),_:1}),t[14]||(t[14]=p(" 배포 "))]),_:2},1032,["onClick","disabled"])])]),_:1})]),_:1},8,["data"])]),e($,{modelValue:c.value,"onUpdate:modelValue":t[9]||(t[9]=o=>c.value=o),title:"프로젝트","align-center":""},{footer:a(()=>[d("div",{onClick:t[8]||(t[8]=o=>c.value=!1)},"취소"),d("div",{onClick:U},"확인")]),default:a(()=>[e(T,{model:l.value,rules:P.value,ref_key:"frmRef",ref:v},{default:a(()=>[e(H,{column:2,border:""},{default:a(()=>[e(u,{label:"프로젝트명","min-width":"100"},{default:a(()=>[e(i,{required:"",prop:"projectName",class:"py-2 !mb-0"},{default:a(()=>[e(s,{modelValue:l.value.projectName,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.projectName=o),placeholder:"프로젝트명"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"주소","min-width":"100"},{default:a(()=>[e(i,{required:"",prop:"projectUrl",class:"py-2 !mb-0"},{default:a(()=>[e(s,{modelValue:l.value.projectUrl,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.projectUrl=o),placeholder:"http://www.domain.com"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"컨테이너명"},{default:a(()=>[e(i,{required:"",prop:"containerName",class:"py-2 !mb-0"},{default:a(()=>[e(s,{modelValue:l.value.containerName,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.containerName=o),placeholder:"컨테이너명"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"이미지명"},{default:a(()=>[e(i,{required:"",prop:"imageName",class:"py-2 !mb-0"},{default:a(()=>[e(s,{modelValue:l.value.imageName,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.imageName=o),placeholder:"이미지명:태그명"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"외부포트"},{default:a(()=>[e(i,{required:"",prop:"etrPort",class:"py-2 !mb-0"},{default:a(()=>[e(s,{modelValue:l.value.etrPort,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.etrPort=o),placeholder:"외부 포트",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"내부포트"},{default:a(()=>[e(i,{required:"",prop:"itrPort",class:"py-2 !mb-0"},{default:a(()=>[e(s,{modelValue:l.value.itrPort,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.itrPort=o),placeholder:"내부 포트",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"도메인"},{default:a(()=>[e(i,{prop:"domainDate",class:"py-2 !mb-0"},{default:a(()=>[e(j,{modelValue:l.value.domainDateRange,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.domainDateRange=o),type:"daterange","start-placeholder":"도메인 등록일","end-placeholder":"도메인 만료일",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"인증서"},{default:a(()=>[e(i,{prop:"sslDate",class:"py-2 !mb-0"},{default:a(()=>[d("div",null,[e(j,{modelValue:l.value.sslDateRange,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.sslDateRange=o),type:"daterange","start-placeholder":"인증서 등록일","end-placeholder":"인증서 만료일",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{ue as default};
